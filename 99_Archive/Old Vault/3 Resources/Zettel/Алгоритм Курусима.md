
---
alias: ["алгоритм курусима", "kurushima's algorithm"]
---

# Алгоритм Курусима

Алгоритм создаёт [[Магический квадрат]].
Работает только для квадратов $n * n$, где $n$ - нечетное число.
Допустим, нужно сгенерировать квадрта $3 * 3$.

## Алгоритм

1. Заполняем центральные 5 клеток по принципу:

|     |
| --- | ------------- | ------------ |
| -   | $n^2$         | -            |
| $n$ | $(n^2 + 1)/2$ | $n^2 + 1 -n$ |
| -   | 1             | -            |

2. Начиная с ячейки, чьё значение известно, определяем неизвестное значение соседней ячейки по одному из трёх [[Алгоритм Курусима#Правила]] ^aa3843
3. Повторяем [[Алгоритм Курусима#^aa3843|п. 2]], пока не заполнится весь квадрат.

### Правила

1. Для любого $x$, мы можем определить ячейку, расположенную по диагонали от $x$, добавив $n$ и вычисляя $result mod n^2$:

|  |
| -------------- | --- |
| -              | x   |
| $x+n(mod n^2)$ | -   |

Мы также можем пойти в обратном направлении, вычитыя $n$.

2. Для любого $x$ в магическом квадрате, ячейка ниже и справа от $x$ больше $x$ на 1 и $mod n^2$:

|  |
| :-- | -------------: |
| x   |
| -   | $x+1(mod n^2)$ |

==Исключение из правила==: правило не применяется при проходе от правого верхнего угла к нижнему левому (по обратной диагонали).

3. Правило применяется при проходе по обратной диагонали:

|  |
| :-- | ---------------: |
| x   |
| -   | $x-n+1(mod n^2)$ |
