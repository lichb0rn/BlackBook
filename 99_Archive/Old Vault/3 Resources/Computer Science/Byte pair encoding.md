---
aliases: ['byte pair encoding', 'BPE', 'токенизация на подслова']
tags: ['']
---

MOC: [[Algorithms]]

---

Идея BPE похоже на коды Хафмана.

**Обучение BPE**

1.  Слово = последовательность токенов (пока символов, изначально использовались unicode символы)
2.  Словарь = все токены (на нулевой итерации — символы)
3.  Повторять пока не достигли ограничения на размер словаря
    - Назначаем новым токеном объединение двух существующих токенов, которое встречается чаще других пар в корпусе (имеется в виду: встречаются вместе).

В применении BPE возможны разные варианты, один из естественных – идём по всем токенам по убыванию частоты, находим соответствующую последовательность символов в корпусе, заменяем на токен.

![bpe](https://alexanderdyakonov.files.wordpress.com/2019/11/bpe.jpg?w=700)

Упрощённая иллюстрация BPE показана на рисунке: здесь нет слов, просто цепочка символов. Мы выписываем частоты (на рис. — числа вхождений) пар символов, которые встречаются в тексте, заменяем самую частую пару на новый символ (вне словаря), и продолжаем этот процесс. Словарь у нас увеличивается в объёме, а цепочка сокращается в длине. Когда нам покажется, что словарь достаточно большой (ну или частоты очень маленькие), мы становимся.
