---
aliases: ["threaded tree", "связное дерево"]
---
MOC:  [[Algorithms]] 

---

Связные деревья являются подвидом [[Бинарное дерево|двоичных деревьев]]. 

```swift
public final class ThreadedNode<Element>  {
    
    public var value: Element
    public var leftChild: ThreadedNode?
    public var rightChild: ThreadedNode?
    public var leftThread: ThreadedNode?
    public var rightThread: ThreadedNode?
    
    
    public init(value: Element) {
        self.value = value
    }
}

public struct ThreadedTree<Element: Comparable> {
    
    public private(set) var root: ThreadedNode<Element>?
    
    public init() {}
    
    public mutating func insert(_ value: Element) {
        guard let root = root else {
            root = ThreadedNode(value: value)
            return
        }
        
        insert(from: root, value: value)
    }
    
    @discardableResult
    private func insert(from node: ThreadedNode<Element>, value: Element) -> ThreadedNode<Element> {
        
        var currentNode: ThreadedNode? = node
        var parent: ThreadedNode<Element>? = nil
        while let node = currentNode {
            parent = currentNode
            
            if value < node.value {
                currentNode = node.leftChild
            } else {
                currentNode = node.rightChild
            }
        }
        
        let child = ThreadedNode(value: value)
        if let parent = parent {
            if value < parent.value {
                child.leftThread = parent.leftThread
                child.rightThread = parent
                parent.leftChild = child
                parent.leftThread = nil
            } else {
                child.leftThread = parent
                child.rightThread = parent.rightThread
                parent.rightChild = child
                parent.rightThread = nil
            }
        }
        return child
    }
    
    
    public func traverseInOrderWithThreads(visit: (Element) -> Void) {
        var current = root
        var routeViaBranch: Bool = true
        
        while var node = current {
            if routeViaBranch {
                while let leftChild = node.leftChild {
                    node = leftChild
                }
            }
            
            visit(node.value)
            
            if let rightChild = node.rightChild {
                current = rightChild
                routeViaBranch = true
            } else {
                current = node.rightThread
                routeViaBranch = false
            }
        }
    }
}
```