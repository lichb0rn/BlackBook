---
aliases: ["heapsort", "пирамидальная сортировка"]
---
MOC:  [[Алгоритмы сортировки]]

---

**Время выполнения:** $O(n \ logn)$
Время выполнения постоянно во всех ситуациях (лучшее, среднее, худшее). Это связано с тем, что нужно балансировать дерево после каждой операции, а это $O(logn)$.

Heapsort использует преимущества [[Двоичная куча|кучи]], которая по определению частично отсортирована.

*Принцип работы*
- Т.к. по определению кучи наибольший (наименьший в случае min heap) находится в вершине дерева, то мы меняем его с последним элементом.
- После смены позиций куча не сбалансирована, поэтому мы "просеиваем" её для балансировки, но последний элемент не учитываем.
- На новом шаге наибольший элемент снова в вершине дерева. Меняем его местами с предпоследним элементом.

Повторяя так n-1 раз мы получаем на выходе отсортированный массив.

## Код
Код является расширением кода [[Двоичная куча|кучи]]
```swift
extension Heap {
    func sorted() -> [Element] {
        
        var heap = Heap(sort: sort, elements: elements)
        for index in heap.elements.indices.reversed() {
            heap.elements.swapAt(0, index)
            heap.siftDown(from: 0, upTo: index)
        }
        
        return heap.elements
    }
}
```